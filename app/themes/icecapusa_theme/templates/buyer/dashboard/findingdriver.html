
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Tranxit - On Ride - User Dashboard</title>
    <link rel="shortcut icon" type="image/png" href="http://18.220.43.48/favicon.ico"/>

    <link href="http://18.220.43.48/asset/css/bootstrap.min.css" rel="stylesheet">
    <link href="http://18.220.43.48/asset/font-awesome/css/font-awesome.min.css" rel="stylesheet">
    <link href="http://18.220.43.48/asset/css/slick.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="http://18.220.43.48/asset/css/slick-theme.css"/>
    <link href="http://18.220.43.48/asset/css/bootstrap-datepicker.min.css" rel="stylesheet">
    <link href="http://18.220.43.48/asset/css/bootstrap-timepicker.css" rel="stylesheet">
    <link href="http://18.220.43.48/asset/css/dashboard-style.css" rel="stylesheet">
</head>

<body>

    <header>
    <nav class="navbar navbar-fixed-top">
      <div class="container">
        <div class="col-md-12">
            <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>             

              <a class="navbar-brand" href="http://18.220.43.48/dashboard"><img src="http://18.220.43.48/logo-black.png"></a>
            </div>
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">            
                <ul class="nav navbar-nav navbar-right">                  
                  <li class="menu-drop">
                      <div class="dropdown">
                          <button class="btn btn-primary dropdown-toggle" type="button" data-toggle="dropdown">Appoets Demo
                          <span class="caret"></span></button>
                          <ul class="dropdown-menu">
                            <li><a href="http://18.220.43.48/trips">My Trips</a></li>
                            <li><a href="http://18.220.43.48/profile">Profile</a></li>
                            <li><a href="http://18.220.43.48/change/password">Change Password</a></li>
                            <li><a href="http://18.220.43.48/logout"
                                    onclick="event.preventDefault();
                                    document.getElementById('logout-form').submit();">Logout</a></li>
                                    <form id="logout-form" action="http://18.220.43.48/logout" method="POST" style="display: none;">
                                        <input type="hidden" name="_token" value="hNgO2Xb3qat9Qd5i6G6EBUaOyn9LJnyzW4dsgq7E">
                                    </form>
                          </ul>
                        </div>
                  </li>
                </ul>
            </div>
        </div>
      </div>
    </nav>
</header>
    <div class="page-content dashboard-page">    
        <div class="container">
            
            <div class="col-md-3">
    <div class="dash-left">
        <div class="user-img">
                        <div class="pro-img" style="background-image: url(http://18.220.43.48/main/avatar.jpg);"></div>
            <h4>Appoets Demo</h4>
        </div>
        <div class="side-menu">
             <ul>
                <li><a href="http://18.220.43.48/dashboard">Dashboard</a></li>
                <li><a href="http://18.220.43.48/trips">My Trips</a></li>
                <li><a href="http://18.220.43.48/upcoming/trips">Upcoming trips</a></li>
                <li><a href="http://18.220.43.48/profile">Profile</a></li>
                <li><a href="http://18.220.43.48/change/password">Change Password</a></li>
                <li><a href="http://18.220.43.48/payment">Payment</a></li>
                <li><a href="http://18.220.43.48/promotion">Promotions</a></li>
                <li><a href="http://18.220.43.48/wallet">My Wallet <span class="pull-right">$100</span></a></li>
                <li><a href="http://18.220.43.48/logout"
                        onclick="event.preventDefault();
                        document.getElementById('logout-form').submit();">Logout</a></li>
                        <form id="logout-form" action="http://18.220.43.48/logout" method="POST" style="display: none;">
                            <input type="hidden" name="_token" value="hNgO2Xb3qat9Qd5i6G6EBUaOyn9LJnyzW4dsgq7E">
                        </form>
            </ul>
        </div>
    </div>
</div>            
<div class="col-md-9">
    <div class="dash-content">
    			<div class="row no-margin">
		    <div class="col-md-12">
		        <h4 class="page-title" id="ride_status"></h4>
		    </div>
		</div>
		
		<div class="row no-margin">
		        <div class="col-md-6" id="container" >
		    		<p>Loading...</p>                             
		        </div>

		        <div class="col-md-6">
		            <dl class="dl-horizontal left-right">
		                <dt>Request ID</dt>
		                <dd>2</dd>
		                <dt>Time</dt>
		                <dd>16-08-2017 08:44 AM</dd>
		            </dl> 
		            <div class="user-request-map">
		                <div class="from-to row no-margin">
		                    <div class="from">
		                        <h5>FROM</h5>
		                        <p>New Amsterdam Library, Murray Street, New York, NY, United States</p>
		                    </div>
		                    <div class="to">
		                        <h5>TO</h5>
		                        <p>Chobani SoHo, Prince Street, New York, NY, United States</p>
		                    </div>
		                    <div class="type">
		                    	<h5>TYPE</h5>
		                        <p>Sedan</p>
		                    </div>
		                </div>
		                		                    <div class="map-static" style="background-image: url(https://maps.googleapis.com/maps/api/staticmap?autoscale=1&amp;size=600x450&amp;maptype=roadmap&amp;format=png&amp;visual_refresh=true&amp;markers=icon:http://18.220.43.48/asset/img/marker-start.png%7C40.7136403,-74.0078452&amp;markers=icon:http://18.220.43.48/asset/img/marker-start.png%7C40.7257536,-74.0011382&amp;path=color:0x191919|weight:8|40.7136403,-74.0078452|40.7257536,-74.0011382&amp;key=AIzaSyDEJUPrYJXDZNgb9KATSHAQYP-7lcchUts);"></div>                               
		            </div>                          
		        </div>
		</div>
	</div>
</div>


        </div>
    </div>


    <div class="row footer no-margin">
        <div class="container">
            <div class="col-md-6 text-left">
                <p>&copy; 2017 Appoets</p>
            </div>
            <div class="col-md-6 col-sm-6 col-xs-12 text-right">
                <a href="" class="app"><img src="http://18.220.43.48/asset/img/appstore.png"></a>
                <a href="" class="app"><img src="http://18.220.43.48/asset/img/playstore.png"></a>
            </div>
        </div>
    </div>

    <script src="http://18.220.43.48/asset/js/jquery.min.js"></script>
    <script src="http://18.220.43.48/asset/js/bootstrap.min.js"></script>       
    <script type="text/javascript" src="http://18.220.43.48/asset/js/jquery.mousewheel.js"></script>
    <script type="text/javascript" src="http://18.220.43.48/asset/js/jquery-migrate-1.2.1.min.js"></script> 
    <script type="text/javascript" src="http://18.220.43.48/asset/js/slick.min.js"></script>
    <script src="http://18.220.43.48/asset/js/bootstrap-datepicker.min.js"></script>
    <script src="http://18.220.43.48/asset/js/bootstrap-timepicker.js"></script>
    <script src="http://18.220.43.48/asset/js/dashboard-scripts.js"></script>

        <script type="text/javascript" src="http://18.220.43.48/asset/js/rating.js"></script>    
	<script type="text/javascript">
		$('.rating').rating();
	</script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.13.3/react.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.13.3/JSXTransformer.js"></script>

    <script type="text/jsx">
		var MainComponent = React.createClass({
			getInitialState: function () {
                    return {data: [], currency : "$0.00"};
                },
			componentDidMount: function(){
				$.ajax({
			      url: "http://18.220.43.48/status",
			      type: "GET"})
			      .done(function(response){

				        this.setState({
				            data:response.data[0]
				        });

				    }.bind(this));

				    setInterval(this.checkRequest, 5000);
			},
			checkRequest : function(){
				$.ajax({
			      url: "http://18.220.43.48/status",
			      type: "GET"})
			      .done(function(response){
				        this.setState({
				            data:response.data[0]
				        });

				    }.bind(this));
			},
			render: function(){
				return (
					<div>
						<SwitchState checkState={this.state.data} currency={this.state.currency} />
					</div>
				);
			}
		});

		var SwitchState = React.createClass({

			componentDidMount: function() {
				this.changeLabel;
			},

			changeLabel : function(){
				if(this.props.checkState == undefined){
					window.location.reload();
				}else if(this.props.checkState != ""){

					if(this.props.checkState.status == 'SEARCHING'){
						$("#ride_status").text("Finding your Driver");
					}else if(this.props.checkState.status == 'STARTED'){
						var provider_name = this.props.checkState.provider.first_name;
						$("#ride_status").text(provider_name+" Accepted Your Ride");
					}else if(this.props.checkState.status == 'ARRIVED'){
						var provider_name = this.props.checkState.provider.first_name;
						$("#ride_status").text(provider_name+" Arrived At your Location");
					}else if(this.props.checkState.status == 'PICKEDUP'){
						$("#ride_status").text("Enjoy your Ride");
					}else if(this.props.checkState.status == 'DROPPED'){
						$("#ride_status").text("Waiting for Payment");
					}else if(this.props.checkState.status == 'COMPLETED'){
						var provider_name = this.props.checkState.provider.first_name;
						$("#ride_status").text("Rate and Review " +provider_name );
					}
					setTimeout(function(){
						$('.rating').rating();
					},400);

				}else{
					$("#ride_status").text('Text will appear here');
				}
			},
			render: function(){

				if(this.props.checkState != ""){

					this.changeLabel();
					if(this.props.checkState.status == 'SEARCHING'){
						return (
							<div>
								<Searching checkState={this.props.checkState} />
							</div>
						);
					}else if(this.props.checkState.status == 'STARTED'){
						return (
							<div>
								<Accepted checkState={this.props.checkState} />
							</div>
						);
					}else if(this.props.checkState.status == 'ARRIVED'){
						return (
							<div>
								<Arrived checkState={this.props.checkState} />
							</div>
						);
					}else if(this.props.checkState.status == 'PICKEDUP'){
						return (
							<div>
								<Pickedup checkState={this.props.checkState} />
							</div>
						);
					}else if((this.props.checkState.status == 'DROPPED' || this.props.checkState.status == 'COMPLETED') && this.props.checkState.payment_mode == 'CASH' && this.props.checkState.paid == 0){
						return (
							<div>
								<DroppedAndCash checkState={this.props.checkState} currency={this.props.currency} />
							</div>
						);
					}else if((this.props.checkState.status == 'DROPPED' || this.props.checkState.status == 'COMPLETED') && this.props.checkState.payment_mode == 'CARD' && this.props.checkState.paid == 0){
						return (
							<div>
								<DroppedAndCard checkState={this.props.checkState} currency={this.props.currency} />
							</div>
						);
					}else if(this.props.checkState.status == 'COMPLETED'){
						return (
							<div>
								<Review checkState={this.props.checkState} />
							</div>
						);
					}
				}else{
					return ( 
						<p></p>
					 );
				}
			}
		});

		var Searching = React.createClass({
			render: function(){
				return (
					<form action="http://18.220.43.48/cancel/ride" method="POST">
						<input type="hidden" name="_token" value="hNgO2Xb3qat9Qd5i6G6EBUaOyn9LJnyzW4dsgq7E"></input>
						<input type="hidden" name="request_id" value={this.props.checkState.id} />
			            <div className="status">
			                <h6>Status</h6>
			                <p>Finding your Driver</p>
			            </div>

		            	<button type="submit" className="full-primary-btn fare-btn">Cancel Request</button> 
		            </form>
				);
			}
		});

		var Accepted = React.createClass({
			render: function(){
				return (
					<form action="http://18.220.43.48/cancel/ride" method="POST">
						<input type="hidden" name="_token" value="hNgO2Xb3qat9Qd5i6G6EBUaOyn9LJnyzW4dsgq7E"></input>
					<input type="hidden" name="request_id" value={this.props.checkState.id} />
						<div className="status">
			                <h6>Status</h6>
			                <p>Accepted Your Ride</p>
			            </div>
		            	<button type="submit" className="full-primary-btn fare-btn">Cancel Request</button> 
		            	<br/>
		            		<h5><strong>Ride Details</strong></h5>
		            	<div className="driver-details">
			            	<dl className="dl-horizontal left-right">
				                <dt>Driver Name</dt>
				                <dd>{this.props.checkState.provider.first_name} {this.props.checkState.provider.last_name}</dd>
				                <dt>Car Number</dt>
				                <dd>{this.props.checkState.provider_service.service_number}</dd>
				                <dt>Car Model</dt>
				                <dd>{this.props.checkState.provider_service.service_model}</dd>
				                <dt>Driver Rating</dt>
				                <dd>
				                	<div className="rating-outer">
			                            <input type="hidden" value={this.props.checkState.provider.rating} name="rating" className="rating"/>
			                        </div>
				                </dd>
				                <dt>Payment Mode</dt>
				                <dd>{this.props.checkState.payment_mode}</dd>
				            </dl> 
			            </div>

		            </form>
				);
			}
		});

		var Arrived = React.createClass({
			render: function(){
				return (
					<form action="http://18.220.43.48/cancel/ride" method="POST">
						<input type="hidden" name="_token" value="hNgO2Xb3qat9Qd5i6G6EBUaOyn9LJnyzW4dsgq7E"></input>
					<input type="hidden" name="request_id" value={this.props.checkState.id} />
						<div className="status">
			                <h6>Status</h6>
			                <p>Arrived At your Location</p>
			            </div>
		            	<button type="submit" className="full-primary-btn fare-btn">Cancel Request</button> 
		            	<br/>
		            		<h5><strong>Ride Details</strong></h5>
		            	<div className="driver-details">
			            	<dl className="dl-horizontal left-right">
				                <dt>Driver Name</dt>
				                <dd>{this.props.checkState.provider.first_name} {this.props.checkState.provider.last_name}</dd>
				                <dt>Car Number</dt>
				                <dd>{this.props.checkState.provider_service.service_number}</dd>
				                <dt>Car Model</dt>
				                <dd>{this.props.checkState.provider_service.service_model}</dd>
				                <dt>Driver Rating</dt>
				                <dd>
				                	<div className="rating-outer">
			                            <input type="hidden" value={this.props.checkState.provider.rating} name="rating" className="rating"/>
			                        </div>
				                </dd>
				                <dt>Payment Mode</dt>
				                <dd>{this.props.checkState.payment_mode}</dd>
				            </dl> 
			            </div>
		            </form>
				);
			}
		});

		var Pickedup = React.createClass({
			render: function(){
				return (
				<div>
					<div className="status">
		                <h6>Status</h6>
		                <p>Enjoy your Ride</p>
		            </div>
		            <br/>
	            		<h5><strong>Ride Details</strong></h5>
	            	<div className="driver-details">
		            	<dl className="dl-horizontal left-right">
			                <dt>Driver Name</dt>
			                <dd>{this.props.checkState.provider.first_name} {this.props.checkState.provider.last_name}</dd>
			                <dt>Car Number</dt>
				                <dd>{this.props.checkState.provider_service.service_number}</dd>
				                <dt>Car Model</dt>
				                <dd>{this.props.checkState.provider_service.service_model}</dd>
			                <dt>Driver Rating</dt>
				                <dd>
				                	<div className="rating-outer">
			                            <input type="hidden" value={this.props.checkState.provider.rating} name="rating" className="rating"/>
			                        </div>
				                </dd>
			                <dt>Payment Mode</dt>
			                <dd>{this.props.checkState.payment_mode}</dd>
			            </dl> 
		            </div>
		        </div>
				);
			}
		});

		var DroppedAndCash = React.createClass({

			render: function(){
				return (
				<div>
					<div className="status">
		                <h6>Status</h6>
		                <p>Your Ride is Completed</p>
		            </div>
		            <br/>
		            	<h5><strong>Ride Details</strong></h5>
		            	<dl className="dl-horizontal left-right">
		            		<dt>Driver Name</dt>
			                <dd>{this.props.checkState.provider.first_name} {this.props.checkState.provider.last_name}</dd>
			                <dt>Car Number</dt>
				                <dd>{this.props.checkState.provider_service.service_number}</dd>
				                <dt>Car Model</dt>
				                <dd>{this.props.checkState.provider_service.service_model}</dd>
			                <dt>Driver Rating</dt>
			                <dd>
			                	<div className="rating-outer">
		                            <input type="hidden" value={this.props.checkState.provider.rating} name="rating" className="rating"/>
		                        </div>
			                </dd>
		            		<dt>Payment Mode</dt>
                        	<dd>{this.props.checkState.payment_mode}</dd>
                        	<dt>Kilometer</dt>
                        	<dd>{this.props.checkState.distance} kms</dd>
                        </dl>
		            	<h5><strong>Invoice</strong></h5>
		            	<dl className="dl-horizontal left-right">
                            <dt>Base Fare</dt>
                            <dd>{this.props.currency}{this.props.checkState.payment.fixed}</dd>
                            <dt>Tax Fare</dt>
                            <dd>{this.props.currency}{this.props.checkState.payment.tax}</dd>
                            <dt>Distance Fare</dt>
                            <dd>{this.props.currency}{this.props.checkState.payment.distance}</dd>
                            {this.props.checkState.use_wallet ?
								<span>
								<dt>Wallet Detection</dt>
                            	<dd>{this.props.currency}{this.props.checkState.payment.wallet}</dd>  
                            	</span>
                            : ''
                            }
                            {this.props.checkState.payment.discount ?
								<span>
								<dt>Promotion Applied</dt>
                            	<dd>{this.props.currency}{this.props.checkState.payment.discount}</dd>  
                            	</span>
                            : ''
                            }
                            <dt>Total</dt>
                            <dd>{this.props.currency}{this.props.checkState.payment.total}</dd> 
                            <dt className="big">Amount to be Paid</dt>
                            <dd className="big">{this.props.currency}{this.props.checkState.payment.total}</dd>
                        </dl>
		        </div>
				);
			}
		});

		var DroppedAndCard = React.createClass({

			render: function(){
				return (
				<div>
					<form method="POST" action="http://18.220.43.48/payment">
						<input type="hidden" name="_token" value="hNgO2Xb3qat9Qd5i6G6EBUaOyn9LJnyzW4dsgq7E"></input>
					<div className="status">
		                <h6>Status</h6>
		                <p>Your Ride is Completed</p>
		            </div>
		            	<br/>
		            	<h5><strong>Ride Details</strong></h5>
		            	<dl className="dl-horizontal left-right">
		            		<dt>Driver Name</dt>
			                <dd>{this.props.checkState.provider.first_name} {this.props.checkState.provider.last_name}</dd>
			                <dt>Car Number</dt>
				                <dd>{this.props.checkState.provider_service.service_number}</dd>
				                <dt>Car Model</dt>
				                <dd>{this.props.checkState.provider_service.service_model}</dd>
			                <dt>Driver Rating</dt>
			                <dd>
			                	<div className="rating-outer">
		                            <input type="hidden" value={this.props.checkState.provider.rating} name="rating" className="rating"/>
		                        </div>
			                </dd>
		            		<dt>Payment Mode</dt>
                        	<dd>{this.props.checkState.payment_mode}</dd>
                        	<dt>Kilometer</dt>
                        	<dd>{this.props.checkState.distance} kms</dd>
                        </dl>
		            	<h5><strong>Invoice</strong></h5>
		            	<input type="hidden" name="request_id" value={this.props.checkState.id} />
		            	<dl className="dl-horizontal left-right">
                            <dt>Base Fare</dt>
                            <dd>{this.props.currency}{this.props.checkState.payment.fixed}</dd>
                            <dt>Tax Fare</dt>
                            <dd>{this.props.currency}{this.props.checkState.payment.tax}</dd>
                            <dt>Distance Fare</dt>
                            <dd>{this.props.currency}{this.props.checkState.payment.distance}</dd>
                            <dt>Total</dt>
                            {this.props.checkState.use_wallet ?
								<span>
								<dt>Wallet Detection</dt>
                            	<dd>{this.props.currency}{this.props.checkState.payment.wallet}</dd>  
                            	</span>
                            : ''
                            }
                            {this.props.checkState.payment.discount ?
								<span>
								<dt>Promotion Applied</dt>
                            	<dd>{this.props.currency}{this.props.checkState.payment.discount}</dd>  
                            	</span>
                            : ''
                            }
                            <dd>{this.props.currency}{this.props.checkState.payment.total}</dd> 
                            <dt className="big">Amount to be Paid</dt>
                            <dd className="big">{this.props.currency}{this.props.checkState.payment.total}</dd>
                        </dl>
                    	<button type="submit" className="full-primary-btn fare-btn">CONTINUE TO PAY</button>   
                    </form>
		        </div>
				);
			}
		});

		var Review = React.createClass({
			render: function(){
				return (
				<form method="POST" action="http://18.220.43.48/rate">
				<input type="hidden" name="_token" value="hNgO2Xb3qat9Qd5i6G6EBUaOyn9LJnyzW4dsgq7E"></input>
                    <div className="rate-review">
                        <label>Rating</label>
                        <div className="rating-outer">
                            <input type="hidden" value="1" name="rating" className="rating"/>
                        </div>
						<input type="hidden" name="request_id" value={this.props.checkState.id} />
                        <label>Comment</label>
                        <textarea className="form-control" name="comment" placeholder="Write Comment"></textarea>
                    </div>
                    <button type="submit" className="full-primary-btn fare-btn">SUBMIT</button>   
                </form>
				);
			}
		});

		React.render(<MainComponent/>,document.getElementById("container"));
	</script>

    
</body>
</html>